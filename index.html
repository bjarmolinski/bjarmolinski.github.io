<!DOCTYPE html>
<html>
    <head>
        <script type='text/javascript'>
            function getQueryParam(name) {
                    const urlParams = new URLSearchParams(window.location.search);
                    return urlParams.get(name);
            }
            
            var contactId = getQueryParam('contactId');
            window.addEventListener("onEmbeddedMessagingReady", e => {
                embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
                    "Customer_ID": contactId
                });
        });
</script>
    </head>
    <body>
        <h1>Welcome to Embedded Messaging</h1>
        <p>Click the chat icon to start a conversation.</p>
        <button onclick="embeddedservice_bootstrap.utilAPI.launchChat()">Click Me</button>
        <script type='text/javascript'>
            function initEmbeddedMessaging() {
                try {
                    embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'
        
                    embeddedservice_bootstrap.init(
                        '00DdM00000JCNpA',
                        'AgentDeployment',
                        'https://orgfarm-75e731efe3-dev-ed.develop.my.site.com/ESWAgentDeployment1738843649715',
                        {
                            scrt2URL: 'https://orgfarm-75e731efe3-dev-ed.develop.my.salesforce-scrt.com'
                        }
                    );
                } catch (err) {
                    console.error('Error loading Embedded Messaging: ', err);
                }
            };
        </script>
        <script type='text/javascript' src='https://orgfarm-75e731efe3-dev-ed.develop.my.site.com/ESWAgentDeployment1738843649715/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>        
        <script>console.log(JSON.stringify(embeddedservice_bootstrap))</script>
    </body>
</html>
